install.packages("caret")
install.packages("devtool")
install.packages("devtools")
devtools::install_github("twitter/AnomalyDetection")
install.packages("randomForest")
install.packages("xgboost")
install.packages("doMS")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("data.table")
devtools::install_github("twitter/AnomalyDetection")
require("AnomalyDetection")
data(raw_data)
res = AnomalyDetectionTs(raw_data, max_anoms=0.02, direction='both', plot=TRUE)
res$plot
AnomalyDetectionVec(raw_data[,2], max_anoms=0.02, period=1440, direction='both', only_last=FALSE, plot=TRUE)
View(raw_data)
res = AnomalyDetectionTs(raw_data, max_anoms=0.02, direction='both', only_last="day", plot=TRUE)
res$plot
str(res)
install.packages("doSMP")
require(doSMP)
install.packages("foreach")
install.packages("doParalle")
install.packages("doParallel")
install.packages("doSNOW")
require(doSNOW)
require(foreach)
registerDoSNOW(4)
l = foreach(i=1:10000) %dopar% sqrt(i)
1/2
path
m<<-3
m
x <-- 3
x
a=10
f <-function (x) {}
f <- function (x) {
x<- x*2
x
}
f(a)
a
c(1,2,3)
install.packages("survival")
install.packages("KMsurv")
library(Ksurv)
library(KMsurv)
install.packages(survival)
install.packages("survival")
library(survival)
args(coxph)
url <- "http://socserv.mcmaster.ca/jfox/Books/Companion/data/Rossi.txt"
Rossi <- read.table(url, header=TRUE)
Rossi[1:5, 1:10]
View(Rossi)
mod.allison <- coxph(Surv(week, arrest) ~
+ fin + age + race + wexp + mar + paro + prio,
+ data=Rossi)
mod.allison <- coxph(Surv(week, arrest) ~
fin + age + race + wexp + mar + paro + prio,
data=Rossi)
mod.allison
summary(mod.allison)
mod2 <- coxph(Surv(week, arrest) ~
fin + age + mar + prio,
data=Rossi)
mod2
plot(survfit(mod.allison), ylim=c(0.7, 1), xlab="Weeks",
ylab="Proportion Not Rearrested")
survfit(mod.allison)
Rossi.fin <- with(Rossi, data.frame(fin=c(0, 1),
age=rep(mean(age), 2), race=rep(mean(race == "other"), 2),
wexp=rep(mean(wexp == "yes"), 2), mar=rep(mean(mar == "not married"), 2),
paro=rep(mean(paro == "yes"), 2), prio=rep(mean(prio), 2)))
plot(survfit(mod.allison, newdata=Rossi.fin), conf.int=TRUE,
lty=c(1, 2), ylim=c(0.6, 1), xlab="Weeks",
ylab="Proportion Not Rearrested")
legend("bottomleft", legend=c("fin = no", "fin = yes"), lty=c(1 ,2), inset=0.02)
args(survfit)
View(Rossi.fin)
survfit(mod.allison, newdata=Rossi.fin)
Rossi[1:5,1]
Rossi[1:5,1:5]
Rossi[1:10,1:5]
Rossi[1:10,1:10]
Rossi[1:10,1:20]
Rossi[1:10,1:25]
Rossi[1:10,10:25]
setwd("~/GitHub/Spikes/R_survival")
foo=read.table("Rossi.txt",header=TRUE
)
str(foo)
Rossi.2 <- unfold(Rossi, time="week",
event="arrest", cov=11:62, cov.names="employed")
install.packages("r-car")
install.packages("car")
library(car
)
unfold
source('~/GitHub/Spikes/R_survival/appendix-cox.R')
source('~/GitHub/Spikes/R_survival/cox_companion.R')
plot(survfit(mod.allison, newdata=Rossi.fin), conf.int=TRUE,
lty=c(1, 2), ylim=c(0.6, 1), xlab="Weeks",
ylab="Proportion Not Rearrested")
legend("bottomleft", legend=c("fin = no", "fin = yes"), lty=c(1 ,2), inset=0.02)
unfold
Rossi.2 <- unfold(Rossi, time="week",
event="arrest", cov=11:62, cov.names="employed")
View(Rossi.2)
mod.allison.2 <- coxph(Surv(start, stop, arrest.time) ~
fin + age + race + wexp + mar + paro + prio + employed,
data=Rossi.2)
summary(mod.allison.2)
Rossi.3 <- unfold(Rossi, "week", "arrest", 11:62, "employed", lag=1)
mod.allison.3 <- coxph(Surv(start, stop, arrest.time) ~
fin + age + race + wexp + mar + paro + prio + employed,
data=Rossi.3)
summary(mod.allison.3)
Rossi.4 = Rossi.3
Rossi.4$last = Rossi.2$employed
View(Rossi.4)
Rossi.4$last = Rossi.2$employed[Rossi.2$start != 0]
Rossi.4 = Rossi.3
Rossi.4$last = Rossi.2$employed[Rossi.2$start != 0]
mod.allison.4 <- coxph(Surv(start, stop, arrest.time) ~
fin + age + race + wexp + mar + paro + prio + employed + last,
data=Rossi.4)
summary(mod.allison.4)
mod.allison.4 <- coxph(Surv(week, arrest) ~ fin + age + prio,
data = Rossi)
summary(mod.allison.4)
cox.zph(mod.allison.4)
czph <- cox.zph(mod.allison.4)
czph
plot(czph)
czph <- cox.zph(mod.allison.4)
czph
par(mfrow=c(2, 2))
plot(czph)
par(mfrow=c(1,1))
mod.allison.5 <- coxph(Surv(start, stop, arrest.time) ~
fin + age + age:stop + prio,
data=Rossi.2)
mod.allison.5
Rossi$age.cat <- recode(Rossi$age, " lo:19=1; 20:25=2; 26:30=3; 31:hi=4 ")
xtabs(~ age.cat, data=Rossi)
mod.allison.6 <- coxph(Surv(week, arrest) ~
fin + prio + strata(age.cat), data=Rossi)
mod.allison.6
mod.allison.6 <- coxph(Surv(week, arrest) ~
fin + prio + (age.cat), data=Rossi)
mod.allison.6
Rossi$age.cat <-as.factor(Rossi$age.cat)
mod.allison.6 <- coxph(Surv(week, arrest) ~
fin + prio + (age.cat), data=Rossi)
mod.allison.6
fin + prio + strata(age.cat), data=Rossi)
